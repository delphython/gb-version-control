![Logo](images\git-logo.png)
# Работа с Git
## 1. Проверка наличия установленного Git
В терминале выполнить команду `git --version`
Если git установлен, появится сообщение с информацией о версии программы. Или появится сообщение об ошибке.

## 2. Установка Git
Загружаем последнюю версию git [отсюда](https://git-scm.com/downloads).
Устанавливаем с настройками по умолчанию.

## 3. Настройка Git
При первом использовании git, необходимо представиться, для это нужно ввести в терминале две команды:
```bash
git config --global user.name "Ваше имя"
git config --global user.email "email@domain.com"
```

## 4. Создание репозитория
Создать репозиторий можно двумя способами:
1. В терминале переходим в папку, в которой хотим создать репозиторий. Выполняем команду:
```bash
git init
```
Данная команда инициализирует локальный репозиторий или превращает каталог, который в настоящее время не находится под версионным контролем в репозиторий Git.

2. Для клонирования существующего репозитория переходим в папку, в которой хотим создать репозиторий и выполняем команду:
```bash
git clone <url>
```
Здесь `url` - ссылка на внешний репозиторий.

## 5. Получение текущей информации о состоянии git
Для определения, какие файлы в каком состоянии находятся, выполняем команду:
```bash
git status
```
Если есть какие-либо изменения в каталоге, то команда их покажет:
```bash
On branch main
Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git restore <file>..." to discard changes in working directory)
        modified:   git_instruction.md

no changes added to commit (use "git add" and/or "git commit -a")
```
Если таких изменений нет, то будет следующее сообщение:
```bash
On branch main
nothing to commit, working tree clean
```
У данной команды есть сокращенный вывод информации:
```bash
git status -s
```

## 6. Добавление под версионный контроль нового файла (файлов)
Для того чтобы добавить новый файл (файлы) в следующий коммит, используется команда:
```bash
git add <file>
```
Чтобы узнать, какой файл (файлы) необходимо добавить в коммит, воспользуйтесь командой `git status`. Инструкция по ее использованию смотрите в п. 5 данного руководства.
Если необходимо добавить в коммит все изменения в каталоге, воспользуйтесь командой:
```bash
git add .
```

## 7. Фиксация изменений (коммит)
Чтобы зафиксировать проиндексированные командой `git add <file>` изменения, воспользуйтесь командой:
```bash
git commit -m "Ваш комментарий к коммиту"
```
Можно объединить сразу две команды `add` и `commit` в одну:
```bash
git commit -am "Ваш комментарий к коммиту"
```
Но имейте ввиду, что в данном случае зафиксируются все изменения в один коммит, в том числе нежелательные.

*Запомните, что для всех файлов, созданных или изменённых вами, для которых вы не выполнили `git add` после редактирования — не войдут в коммит.*

## 8. Вывод на экран истории всех коммитов
Для просмотра истории коммитов (если она есть) запустите команду:
```bash
git log
```
По умолчанию команда перечисляет коммиты, сделанные в репозитории в обратном к хронологическому порядке — последние коммиты находятся вверху. Команда показывает коммиты с их хеш-кодами, именем и электронной почтой автора, датой создания и сообщением коммита.
У команды есть вывод информации в сокращенном виде:
```bash
git log --oneline
```

## 9. Переход от одного коммита к другому
Для перемещения между коммитами используется команда:
```bash
git checkout <hash>
```
Здесь `hash` - хеш-код коммита. Его можно получить с помощью команды `git log` (п. 8 данного руководства).
Для возврата к актуальному состоянию работы с проектом воспользуйтесь командой:
```bash
git checkout <основная ветка>
```
или
```bash
git switch -
```
*Важно помнить, что `git checkout <hash>` опасная команда. В обязательном порядке возвращайтесь к актуальному состоянию работы с проектом, кроме случаев, когда вы возвращаетесь к определенному коммиту осознано.*

## 10. Сравнение изменений
Для просмотра изменений в файлах запустите команду:
```bash
git diff
```
Вывод команды показывает добавленные и удаленные строки.
Изменения в отдельном файле можно посмотреть командой:
```bash
git diff <file>
```

## 11. Игнорирование файлов
Git рассматривает каждый файл в вашей рабочей копии как файл одного из трех типов: отслеживаемый файл — файл, который был предварительно проиндексирован или зафиксирован в коммите, неотслеживаемый файл — файл, который не был проиндексирован или зафиксирован в коммите и игнорируемый файл — файл, явным образом помеченный для Git как файл, который необходимо игнорировать. 

Игнорируемые файлы — это файлы, которые по какой-либо причине не должны попадать в коммиты. Например:
* кэши зависимостей;
* скомпилированный код;
* каталоги для выходных данных сборки;
* файлы, сгенерированные во время выполнения;
* скрытые системные файлы;
* личные файлы конфигурации IDE и другое.

Игнорируемые файлы отслеживаются в специальном файле .gitignore. Его необходимо создать в корневом каталоге репозитория, затем вручную отредактировать файл, указав в нем новые файлы, которые должны быть проигнорированы. Например, ниже на картинке показана часть шаблона .gitignore для python проекта.
![Пример .gitignore](images\gitignore.jpg)
В файле можно указать конкретный файл или каталог, все файлы с определенным расширением, например `*.log` и т.д.

## 12. Создание новой ветки
Ветвление используется чтобы отклониться от основной линии разработки и продолжить работу независимо от неё, не вмешиваясь в основную линию. Преимущество веток в их независимости. Вы можете вносить изменения в файлы в одной ветке, например, пробовать новую функцию, и они никак не скажутся на файлах в другой ветке
С точки зрения логики, ветка – это последовательность коммитов. Ветка — это некоторая временная шкала. Коммиты в ней – снимки интересных моментов, идущие друг за другом в хронологической последовательности. На физическом уровне ветка – это ссылка на последний коммит в этой ветке.

Чтобы добавить новую ветку, необходимо ввести команду:
```bash
git branch <name>
```
Здесь `<name>` - наименование новой ветки.

При создании ветки создаётся новый указатель для дальнейшего перемещения.

Можно одновременно создать новую ветку и перейти на нее с помощью команды:
```bash
git checkout -b <name>
```

Чтобы вывести список всех созданных веток, необходимо ввести команду:
```bash
git branch
```
## 13. Слияние веток
Слияние используется в Git, чтобы собрать воедино разветвленную историю, соединить отдельные направления разработки, созданных с помощью команды `git branch`, в единую ветку. Чаще всего объединяют две ветки. Для начала нам надо перейти в ту ветку, в которую мы хотим внести изменения. Для этого воспользуемся командой:
```bash
git checkout <name1>
```
Затем внесем изменения в текущую ветку из другой ветки `<name2>` с помощью команды:
```bash
git merge <name2>
```
Обратите внимание, что ветка `<name2>` остается без изменений.
Ветка `master` (или может быть другое наименование) — это основная ветка проекта, в которую заливается только рабочий проверенный код. В различных компаниях и командах могут быть приняты другие соглашения насчет веток. Например, что весь функционал сначала сливается в промежуточную ветку.

## 14. Разрешение конфликтов
Обычно конфликты возникают, когда два человека изменяют одни и те же строки в файле или один разработчик удаляет файл, который в это время изменяет другой разработчик. В таких случаях Git не может автоматически определить, какое изменение является правильным. Конфликты затрагивают только того разработчика, который выполняет слияние, остальная часть команды о конфликте не знает. Git помечает файл как конфликтующий и останавливает процесс слияния. В этом случае ответственность за разрешение конфликта несут разработчики.
Существует два типа конфликта:
1. Git прерывает работу в самом начале слияния;
2. Git прерывает работу во время слияния.

В первом случае конфликт возникает, если Git обнаруживает изменения в рабочем каталоге или разделе проиндексированных файлов текущего проекта. Git не может выполнить слияние, поскольку иначе эти ожидающие изменения будут перезаписаны новыми коммитами. Такое случается из-за конфликтов с ожидающими локальными изменениями. Чтобы разрешить данный конфликт, необходимо закоммитить текущие изменения (смотрите пункт 7 данного руководства).

Во втором случае сбой в процессе слияния говорит о наличии конфликта между текущей локальной веткой и веткой, с которой выполняется слияние. Чтобы разрешить данный конфликт, необходимо выбрать ветку из двух основной, т.е. ту ветку, изменения которой взяты за основу и будут использоваться в дальнейшем. Например, при использовании Visual Studio Code в качестве редактора такой выбор можно сделать, используя возможности данного редактора:
![Разрешение конфликта](images\conflict.jpg)
Здесь можно выбрать либо `Accept Current Change` - текущую ветку, либо `Accept Incoming Change` - другую ветку или все изменения `Accept Both Changes`. То, хотите ли вы принять текущие изменения, входящие изменения или все изменения, зависит от ваших целей. При принятии решения вы ориентируетесь на свое понимание этих изменений. Не забудьте сделать коммит слияния.

## 15. Удаление веток
Большинство веток в ваших репозиториях, скорее всего, будут короткоживущими: создали ветку, протестировали новую функцию, слили ветку с основной и удалили ее. Как и всегда, когда речь доходит до удаления чего-либо, нужно быть очень осторожным. Когда вы удаляете ветку, все изменения, которые не были добавлены в коммит, будут утеряны.
Чтобы удалить ветку `<name>`, необходимо выполнить команду:
```bash
git branch -d <name>
```
В данном случае ветка будет удалена только тогда, когда она полностью слита с одной из других веток. В противном случае, Git выдаст предупреждение, что в ветке есть неслитые изменения и не даст их удалить.
Если нужно удалить ветку, игнорируя все предупреждения Git, то надо запускать эту же команду, но с другим ключом: 
```bash
git branch -D <name>
```
Ветка удалится в любом случае, даже если в ней есть изменения, которые потеряются после удаления.

## 16. Работа с GitHub
[GitHub](https://github.com/) — сервис онлайн-хостинга репозиториев, обладающий всеми функциями распределённого контроля версий и функциональностью управления исходным кодом — всё, что поддерживает Git и даже больше. Также GitHub может похвастаться контролем доступа, багтрекингом, управлением задачами и вики для каждого проекта. Git-репозиторий, загруженный на GitHub, доступен с помощью интерфейса командной строки Git и Git-команд. Кроме GitHub есть другие сервисы, которые используют Git, — например, Bitbucket и GitLab.
Итак, рассмотрим основные моменты по работе с удаленными репозиториями:

1. Прежде чем начать работу с GitHub, необходимо там зарегистрироваться, если вы еще это не сделали.

2. У вас есть локальный репозиторий, который вы хотите разместить на GitHub. Для начала вам надо создать в нем новый репозиторий. Для этого нажмите на кнопку `+` в правом верхнем углу и выберите `New repository`:
![Новый репозиторий](images\new_repo.jpg)
Далее выбираете имя для репозитория (система проверит имя на уникальность в рамках вашего аккаунта), вводите описание (не обязательно), выбираете публичный (любой человек увидеть этот репозиторий, но вы выбираете, кто может вносить изменения) или частный репозиторий (вы выбираете, кто может видеть и кто может вносить изменения). Дополнительно можно инициализировать репозиторий с пустым README.md, выбрать и добавить шаблон .gitignore и выбрать лицензию (есть предупреждение, что можно пропустить данный гаг, если вы импортируйте из существующего репозитория) и нажимаете кнопку `Create repository`.
Далее предлагается, а что собственно дальше с новым репозиторием делать:
* продолжить настройку репозитория с помощью дескотопного клиента или скопировать ссылку на репозиторий;
* создать новый репозиторий с помощью Командной строки;
* загрузить существующий репозиторий с помощью Командной строки;
* импортировать код из другого репозитория.

3. Мы воспользуемся третьим вариантом - загрузим существующий репозиторий с помощью Командной строки. Для этого необходимо набрать последовательно три команды:
```bash
git remote add <name1> <url>
git branch -M <name2>
git push -u <name1> <name2>
```
Первая команда создает новое подключение с именем `<name1>` к удаленному репозиторию `<url>`. Например `git remote add origin https://github.com/delphython/gb-version-control.git`. Эта команда будет выполнена, но система не предоставит никакой обратной связи в окне терминала.
Чтобы убедиться, что удаленное хранилище было добавлено в вашу конфигурацию, используйте команду `git remote –v`.
Вторая команда переименовывает ветку в `<name2>` и игнориует ошибки, например, что ветка с таким именем существует. Например `git branch -M main`.
Третья команда загружает текущий локальный репозиторий в удаленные хранилище. При этом создаётся (если ещё не существует) в удалённом репозитории ветка, соответствующая локальной и связываете их. Например `git push -u origin main`. Если `push` Делается первый раз, то потребуется авторизация, о чем Git вас известит.
После выполнения всех этих трех команд необходимо убедиться, что на удаленном репозитории есть все файлы, что в локальном. Для этого зайдите на GitHub и посмотрите на содержимое недавно созданного репозитория.

4. На удаленном репозитории могут вносится изменения, например, на странице GitHub репозитория или выдали доступ к репозиторию другому программисту и он внес свои изменения. Теперь нам надо перенести изменения из удаленного репозитория в локальный. Для этого воспользуемся командой:
```bash
git pull
```

5. Часто разработчики делают параллельные изменения кода. Например, один разработчик работает над внешним видом сайта, а другой занимается размещением контента на нем. По окончании работы ветки каждого из них можно объединить в одну, чтобы создать коммит со всеми внесенными разработчиками изменениями. Для этого в Git используют функцию pull request. Pull request — это заявка на слияние кода из разных веток. В процессе слияния Git создаст коммит и покажет все изменения в файле кода: добавленные до разветвления строки подсветятся зеленым цветом, удаленные — красным. Так каждый из разработчиков и менеджер проекта увидят, что произошло с кодом после совместной работы над коммитом. Перед окончательным слиянием все разработчики должны просмотреть изменения кода и принять их.
Для того, чтобы сделать pull request необходимо выполнить несколько шагов:
* Форкните проект.
* Склонируйте репозиторий.
* Создайте ветку для своей работы.
* Сделайте необходимые изменения в файлах — коде, документации, тестах. Закоммитьте их в только что созданную ветку.
* Убедитесь, что проект работает после ваших изменений.
* Сделайте Pull Request.
* Обсудите его с рецензентом в процессе Code Review. При необходимости, внесите изменения в свой Pull Request.
* Когда все довольны, Pull Request принимают — с этого момента ваши изменения попали в исходный репозиторий (upstream) и являются частью проекта.


## Заключение
 ***В процессе разработки ПО значимая роль отводится сотрудничеству. В большинстве случаев деятельность разработчика включает работу в команде и совместное использование проекта с другими специалистами. Практический опыт использования системы контроля версий не просто важен, а ВАЖЕН для всех, кто намерен заниматься разработкой ПО.*** 
